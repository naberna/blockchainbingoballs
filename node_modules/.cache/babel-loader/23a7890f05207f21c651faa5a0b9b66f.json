{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.decrypt = exports.encrypt = exports.supportedAlgorithms = exports.executeKdf = exports.cosmjsSalt = void 0;\n\nconst crypto_1 = require(\"@cosmjs/crypto\");\n\nconst encoding_1 = require(\"@cosmjs/encoding\");\n/**\n * A fixed salt is chosen to archive a deterministic password to key derivation.\n * This reduces the scope of a potential rainbow attack to all CosmJS users.\n * Must be 16 bytes due to implementation limitations.\n */\n\n\nexports.cosmjsSalt = (0, encoding_1.toAscii)(\"The CosmJS salt.\");\n\nasync function executeKdf(password, configuration) {\n  switch (configuration.algorithm) {\n    case \"argon2id\":\n      {\n        const options = configuration.params;\n        if (!(0, crypto_1.isArgon2idOptions)(options)) throw new Error(\"Invalid format of argon2id params\");\n        return crypto_1.Argon2id.execute(password, exports.cosmjsSalt, options);\n      }\n\n    default:\n      throw new Error(\"Unsupported KDF algorithm\");\n  }\n}\n\nexports.executeKdf = executeKdf;\nexports.supportedAlgorithms = {\n  xchacha20poly1305Ietf: \"xchacha20poly1305-ietf\"\n};\n\nasync function encrypt(plaintext, encryptionKey, config) {\n  switch (config.algorithm) {\n    case exports.supportedAlgorithms.xchacha20poly1305Ietf:\n      {\n        const nonce = crypto_1.Random.getBytes(crypto_1.xchacha20NonceLength); // Prepend fixed-length nonce to ciphertext as suggested in the example from https://github.com/jedisct1/libsodium.js#api\n\n        return new Uint8Array([...nonce, ...(await crypto_1.Xchacha20poly1305Ietf.encrypt(plaintext, encryptionKey, nonce))]);\n      }\n\n    default:\n      throw new Error(`Unsupported encryption algorithm: '${config.algorithm}'`);\n  }\n}\n\nexports.encrypt = encrypt;\n\nasync function decrypt(ciphertext, encryptionKey, config) {\n  switch (config.algorithm) {\n    case exports.supportedAlgorithms.xchacha20poly1305Ietf:\n      {\n        const nonce = ciphertext.slice(0, crypto_1.xchacha20NonceLength);\n        return crypto_1.Xchacha20poly1305Ietf.decrypt(ciphertext.slice(crypto_1.xchacha20NonceLength), encryptionKey, nonce);\n      }\n\n    default:\n      throw new Error(`Unsupported encryption algorithm: '${config.algorithm}'`);\n  }\n}\n\nexports.decrypt = decrypt;","map":{"version":3,"mappings":";;;;;;;AAAA;;AAOA;AAEA;;;;;;;AAKaA,qBAAa,wBAAQ,kBAAR,CAAb;;AAWN,eAAeC,UAAf,CAA0BC,QAA1B,EAA4CC,aAA5C,EAA2E;EAChF,QAAQA,aAAa,CAACC,SAAtB;IACE,KAAK,UAAL;MAAiB;QACf,MAAMC,OAAO,GAAGF,aAAa,CAACG,MAA9B;QACA,IAAI,CAAC,gCAAkBD,OAAlB,CAAL,EAAiC,MAAM,IAAIE,KAAJ,CAAU,mCAAV,CAAN;QACjC,OAAOC,kBAASC,OAAT,CAAiBP,QAAjB,EAA2BF,kBAA3B,EAAuCK,OAAvC,CAAP;MACD;;IACD;MACE,MAAM,IAAIE,KAAJ,CAAU,2BAAV,CAAN;EAPJ;AASD;;AAVDP;AAyBaA,8BAAsB;EACjCU,qBAAqB,EAAE;AADU,CAAtB;;AAIN,eAAeC,OAAf,CACLC,SADK,EAELC,aAFK,EAGLC,MAHK,EAG0B;EAE/B,QAAQA,MAAM,CAACV,SAAf;IACE,KAAKJ,4BAAoBU,qBAAzB;MAAgD;QAC9C,MAAMK,KAAK,GAAGP,gBAAOQ,QAAP,CAAgBR,6BAAhB,CAAd,CAD8C,CAE9C;;QACA,OAAO,IAAIS,UAAJ,CAAe,CACpB,GAAGF,KADiB,EAEpB,IAAI,MAAMP,+BAAsBG,OAAtB,CAA8BC,SAA9B,EAAyCC,aAAzC,EAAwDE,KAAxD,CAAV,CAFoB,CAAf,CAAP;MAID;;IACD;MACE,MAAM,IAAIR,KAAJ,CAAU,sCAAsCO,MAAM,CAACV,SAAS,GAAhE,CAAN;EAVJ;AAYD;;AAjBDJ;;AAmBO,eAAekB,OAAf,CACLC,UADK,EAELN,aAFK,EAGLC,MAHK,EAG0B;EAE/B,QAAQA,MAAM,CAACV,SAAf;IACE,KAAKJ,4BAAoBU,qBAAzB;MAAgD;QAC9C,MAAMK,KAAK,GAAGI,UAAU,CAACC,KAAX,CAAiB,CAAjB,EAAoBZ,6BAApB,CAAd;QACA,OAAOA,+BAAsBU,OAAtB,CAA8BC,UAAU,CAACC,KAAX,CAAiBZ,6BAAjB,CAA9B,EAAsEK,aAAtE,EAAqFE,KAArF,CAAP;MACD;;IACD;MACE,MAAM,IAAIR,KAAJ,CAAU,sCAAsCO,MAAM,CAACV,SAAS,GAAhE,CAAN;EANJ;AAQD;;AAbDJ","names":["exports","executeKdf","password","configuration","algorithm","options","params","Error","crypto_1","execute","xchacha20poly1305Ietf","encrypt","plaintext","encryptionKey","config","nonce","getBytes","Uint8Array","decrypt","ciphertext","slice"],"sourceRoot":"","sources":["../src/wallet.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}