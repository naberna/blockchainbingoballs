import{appendToQueryString as t,getQueryString as e,parseWalletConnectUri as n,getLocal as i,setLocal as o,removeLocal as r,getClientMeta as s}from"@deficonnect/utils";import c from"@deficonnect/web3-provider";import a from"@deficonnect/core";import*as l from"@deficonnect/iso-crypto";import h from"@deficonnect/socket-transport";import{isIOS as d,formatIOSMobile as u,saveMobileLinkInfo as p,isAndroid as f}from"@deficonnect/browser-utils";import v from"qrcode";import{pubkeyType as g}from"@cosmjs/amino";import{fromBase64 as m,toBase64 as y}from"@cosmjs/encoding";import{TxBody as w,AuthInfo as x,TxRaw as b}from"cosmjs-types/cosmos/tx/v1beta1/tx";import{isTsProtoGeneratedType as C}from"@cosmjs/proto-signing";import{defaultRegistryTypes as E}from"@cosmjs/stargate";import{InjectedConnector as _}from"@web3-react/injected-connector";var I,L="object"==typeof Reflect?Reflect:null,S=L&&"function"==typeof L.apply?L.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};I=L&&"function"==typeof L.ownKeys?L.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var k=Number.isNaN||function(t){return t!=t};function F(){F.init.call(this)}var R=F;F.EventEmitter=F,F.prototype._events=void 0,F.prototype._eventsCount=0,F.prototype._maxListeners=void 0;var O,N=10;function T(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function A(t){return void 0===t._maxListeners?F.defaultMaxListeners:t._maxListeners}function D(t,e,n,i){var o,r,s;if(T(n),void 0===(r=t._events)?(r=t._events=Object.create(null),t._eventsCount=0):(void 0!==r.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),r=t._events),s=r[e]),void 0===s)s=r[e]=n,++t._eventsCount;else if("function"==typeof s?s=r[e]=i?[n,s]:[s,n]:i?s.unshift(n):s.push(n),(o=A(t))>0&&s.length>o&&!s.warned){s.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=t,c.type=e,c.count=s.length,console&&console.warn&&console.warn(c)}return t}function B(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function M(t,e,n){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},o=B.bind(i);return o.listener=n,i.wrapFn=o,o}function z(t,e,n){var i=t._events;if(void 0===i)return[];var o=i[e];return void 0===o?[]:"function"==typeof o?n?[o.listener||o]:[o]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(o):U(o,o.length)}function j(t){var e=this._events;if(void 0!==e){var n=e[t];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function U(t,e){for(var n=new Array(e),i=0;i<e;++i)n[i]=t[i];return n}function q(t,e,n,i){if("function"==typeof t.on)i.once?t.once(e,n):t.on(e,n);else{if("function"!=typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t);t.addEventListener(e,function o(r){i.once&&t.removeEventListener(e,o),n(r)})}}Object.defineProperty(F,"defaultMaxListeners",{enumerable:!0,get:function(){return N},set:function(t){if("number"!=typeof t||t<0||k(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");N=t}}),F.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},F.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||k(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},F.prototype.getMaxListeners=function(){return A(this)},F.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var i="error"===t,o=this._events;if(void 0!==o)i=i&&void 0===o.error;else if(!i)return!1;if(i){var r;if(e.length>0&&(r=e[0]),r instanceof Error)throw r;var s=new Error("Unhandled error."+(r?" ("+r.message+")":""));throw s.context=r,s}var c=o[t];if(void 0===c)return!1;if("function"==typeof c)S(c,this,e);else{var a=c.length,l=U(c,a);for(n=0;n<a;++n)S(l[n],this,e)}return!0},F.prototype.on=F.prototype.addListener=function(t,e){return D(this,t,e,!1)},F.prototype.prependListener=function(t,e){return D(this,t,e,!0)},F.prototype.once=function(t,e){return T(e),this.on(t,M(this,t,e)),this},F.prototype.prependOnceListener=function(t,e){return T(e),this.prependListener(t,M(this,t,e)),this},F.prototype.off=F.prototype.removeListener=function(t,e){var n,i,o,r,s;if(T(e),void 0===(i=this._events))return this;if(void 0===(n=i[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(o=-1,r=n.length-1;r>=0;r--)if(n[r]===e||n[r].listener===e){s=n[r].listener,o=r;break}if(o<0)return this;0===o?n.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(n,o),1===n.length&&(i[t]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",t,s||e)}return this},F.prototype.removeAllListeners=function(t){var e,n,i;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[t]),this;if(0===arguments.length){var o,r=Object.keys(n);for(i=0;i<r.length;++i)"removeListener"!==(o=r[i])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(void 0!==e)for(i=e.length-1;i>=0;i--)this.removeListener(t,e[i]);return this},F.prototype.listeners=function(t){return z(this,t,!0)},F.prototype.rawListeners=function(t){return z(this,t,!1)},F.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):j.call(t,e)},F.prototype.listenerCount=j,F.prototype.eventNames=function(){return this._eventsCount>0?I(this._events):[]},R.once=function(t,e){return new Promise(function(n,i){function o(n){t.removeListener(e,r),i(n)}function r(){"function"==typeof t.removeListener&&t.removeListener("error",o),n([].slice.call(arguments))}q(t,e,r,{once:!0}),"error"!==e&&function(t,e,n){"function"==typeof t.on&&q(t,"error",e,{once:!0})}(t,o)})},function(t){t.Update="Web3ReactUpdate",t.Error="Web3ReactError",t.Deactivate="Web3ReactDeactivate"}(O||(O={}));var W=
/*#__PURE__*/
function(t){var e,n;function i(e){var n,i=(void 0===e?{}:e).supportedChainIds;return(n=t.call(this)||this).supportedChainIds=i,n}n=t,(e=i).prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n;var o=i.prototype;return o.emitUpdate=function(t){"production"!==process.env.NODE_ENV&&console.log("Emitting '"+O.Update+"' with payload",t),this.emit(O.Update,t)},o.emitError=function(t){"production"!==process.env.NODE_ENV&&console.log("Emitting '"+O.Error+"' with payload",t),this.emit(O.Error,t)},o.emitDeactivate=function(){"production"!==process.env.NODE_ENV&&console.log("Emitting '"+O.Deactivate+"'"),this.emit(O.Deactivate)},i}(R.EventEmitter);function P(){return P=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},P.apply(this,arguments)}const V=t=>t&&0!==t.length?t.split("?")[0]:t,H=(n,i)=>{if(!n||0===n.length)return n;const o=n.split("?"),r=t("?"+e(o[1]||""),i);return o[0]+"?"+r},G=(t,e)=>{const i=n(t),o=encodeURIComponent(H(decodeURIComponent(i.bridge),e));return`${i.protocol}:${i.handshakeTopic}@${i.version}?bridge=${o}&key=${i.key}`},$=(t,e)=>{const i=n(t),o=encodeURIComponent(V(decodeURIComponent(i.bridge)));return`${e}:${i.handshakeTopic}@${i.version}?bridge=${o}&key=${i.key}`},Z=t=>$(t,"CWE"),Q=t=>$(t,"wc"),J=(t,e=20)=>{let n=t;return n=n.substr(0,e)+(n.length>e?"...":""),n};class K{constructor(t){var e;this.connector=void 0,this.transport=void 0,this.sessionStorage=void 0;const{connectorOpts:i,sessionStorage:o,exists:r}=t;this.sessionStorage=o;const s=(null==i?void 0:i.session)||(null==o?void 0:o.getSession());let c,d,u=null!=(e=null==i?void 0:i.bridge)?e:null==s?void 0:s.bridge;if(!u&&null!=i&&i.uri&&(u=n(i.uri).bridge),r?c=r.transport:u&&(c=new h({protocol:"wc",version:3,url:u})),!c)throw new Error("bridge can not be null");if(r?d=r.connector:i&&(d=new a({cryptoLib:l,connectorOpts:i,sessionStorage:o,transport:c})),!d)throw new Error("connectorOpts can not be null");this.connector=d,this.transport=c,this.transport.subscribe(d.clientId)}clearSessionStorage(){var t;this.sessionStorage?this.sessionStorage.removeSession():null==(t=this.connector._sessionStorage)||t.removeSession()}}const X=["svg","g","path","mask","defs","stop","linearGradient","filter","feFlood","feOffset","feGaussianBlur","feColorMatrix","feBlend"],Y=["floodOpacity"],tt={onClick:"click"};function et(t,e={},...n){if("function"==typeof t)return t(e);null===e&&(e={});const i=X.includes(t)?(t=>{const e=document.createElementNS("http://www.w3.org/2000/svg",t);return"svg"===t&&e.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),e})(t):document.createElement(t);if(Object.keys(e).forEach(t=>{t in tt?i.addEventListener(tt[t],e[t]):Y.includes(t)?i.setAttribute(t.replace(/([A-Z])/g,"-$1").toLowerCase(),e[t]):i.setAttribute(t,e[t])}),"style"in e){const t=e.style;Object.keys(t).forEach(e=>{const n=t[e];if("number"==typeof n)i.style[e]=`${n}`;else{if("string"!=typeof n)throw new Error(`Expected "number" or "string" but received "${typeof n}"`);i.style[e]=n}})}return n.forEach(t=>{if("object"==typeof t)i.appendChild(t);else{if("string"!=typeof t)throw new Error(`Expected "object" or "string" but received "${typeof t}"`);i.appendChild(document.createTextNode(t))}}),i}function nt(t){return et("svg",P({width:60,height:60,viewBox:"5 5 66 66",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),et("g",{filter:"url(#prefix__filter0_d)"},et("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M42.054 20.5c4.016 0 6.023 0 8.185.683a8.495 8.495 0 015.078 5.078c.683 2.161.683 4.17.683 8.185v12.108c0 4.016 0 6.023-.683 8.185a8.494 8.494 0 01-5.078 5.077c-2.162.684-4.169.684-8.185.684H29.946c-4.016 0-6.024 0-8.185-.684a8.494 8.494 0 01-5.078-5.077C16 52.577 16 50.57 16 46.554V34.446c0-4.016 0-6.024.683-8.185a8.495 8.495 0 015.078-5.078c2.161-.683 4.169-.683 8.185-.683h12.108z",fill:"#fff"}),et("mask",{id:"prefix__a",maskUnits:"userSpaceOnUse",x:16,y:20,width:40,height:41},et("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M42.054 20.5c4.016 0 6.023 0 8.185.683a8.495 8.495 0 015.078 5.078c.683 2.161.683 4.17.683 8.185v12.108c0 4.016 0 6.023-.683 8.185a8.494 8.494 0 01-5.078 5.077c-2.162.684-4.169.684-8.185.684H29.946c-4.016 0-6.024 0-8.185-.684a8.494 8.494 0 01-5.078-5.077C16 52.577 16 50.57 16 46.554V34.446c0-4.016 0-6.024.683-8.185a8.495 8.495 0 015.078-5.078c2.161-.683 4.169-.683 8.185-.683h12.108z",fill:"#fff"})),et("g",{mask:"url(#prefix__a)",fillRule:"evenodd",clipRule:"evenodd"},et("path",{d:"M35.98 24.485l-14.042 8.01v16.023L35.98 56.53l14.043-8.012V32.496L35.98 24.485z",fill:"#FEFEFE"}),et("path",{d:"M35.98 24.485l-14.042 8.01v16.023L35.98 56.53l14.043-8.012V32.496L35.98 24.485zm-5.544 6.927h11.051l1.333 5.567H29.154l1.282-5.567zm3.184 9.517l-1.205-3.11h7.156l-1.18 3.11.343 3.474-2.754.012h-2.728l.368-3.486zm3.515 7.16v-1.103l2.474-2.344v-3.7l3.236-2.081 3.693 2.746-5.026 8.652H39.52l-2.385-2.17zm-11.711-6.482l3.704-2.721 3.274 2.056v3.7l2.474 2.344v1.103l-2.385 2.195h-2.018l-5.05-8.677z",fill:"#002D72"}),et("path",{d:"M41.512 50.259H39.52l-2.385-2.17v-1.103l2.474-2.345v-3.7l3.236-2.08 3.693 2.746-5.026 8.652zM35.98 24.485v6.927h5.507l1.333 5.567h-6.84v.84h3.591l-1.18 3.11.343 3.474-2.754.012V56.53l14.043-8.012V32.496L35.98 24.485z",fill:"url(#prefix__paint0_linear)",style:{mixBlendMode:"multiply"}}),et("path",{d:"M34.876 48.09l-2.385 2.194h-2.018l-5.05-8.677 3.705-2.721 3.274 2.056v3.7l2.474 2.344v1.103zm-1.624-3.675l.368-3.486-1.205-3.11h3.565v-.84h-6.826l1.282-5.567h5.544v-6.927l-14.042 8.01v16.023L35.98 56.53V44.415h-2.728z",fill:"url(#prefix__paint1_linear)",style:{mixBlendMode:"multiply"}}))),et("defs",null,et("linearGradient",{id:"prefix__paint0_linear",x1:48.526,y1:53.073,x2:48.526,y2:27.863,gradientUnits:"userSpaceOnUse"},et("stop",{stopColor:"#002D72"}),et("stop",{offset:1,stopColor:"#002D72",stopOpacity:.01})),et("linearGradient",{id:"prefix__paint1_linear",x1:34.483,y1:53.073,x2:34.483,y2:27.863,gradientUnits:"userSpaceOnUse"},et("stop",{stopColor:"#002D72",stopOpacity:.01}),et("stop",{offset:1,stopColor:"#002D72"})),et("filter",{id:"prefix__filter0_d",x:-4,y:.5,width:80,height:80,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},et("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),et("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),et("feOffset",null),et("feGaussianBlur",{stdDeviation:10}),et("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.1 0"}),et("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow"}),et("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow",result:"shape"}))))}function it(t){return et("svg",P({width:20,height:21,viewBox:"0 0 20 21",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),et("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.586 2.167H2.361a.694.694 0 00-.694.694v6.606h1.389V3.556h5.53v-1.39zm2.828 1.389v-1.39h6.225c.384 0 .694.312.694.695v6.606h-1.388V3.556h-5.53zm0 13.889h5.53v-5.223h1.39v5.917c0 .383-.311.694-.695.694h-6.225v-1.388zm-8.358-5.223v5.223h5.53v1.388H2.361a.695.695 0 01-.694-.694v-5.917h1.389z",fill:"#0B1426"}),et("path",{fill:"#0B1426",d:"M5.833 9.667h8.333v1.667H5.833z"}))}function ot(){return et("svg",{xmlns:"http://www.w3.org/2000/svg",width:"27",height:"32",fill:"none",viewBox:"0 0 27 32"},et("path",{fill:"#828FA1",fillRule:"evenodd",d:"M0 8.56v15.237l13.024 7.62 13.021-7.62V8.56L13.024.941 0 8.561zm1.146 14.57V9.23L13.024 2.28 24.903 9.23V23.13l-11.879 6.95-11.878-6.95z",clipRule:"evenodd"}),et("path",{fill:"#828FA1",fillRule:"evenodd",d:"M18.128 7.52H7.894l-1.186 5.287h12.653L18.128 7.52zM9.71 20.083V16.57l-3.032-1.953-3.43 2.584 4.676 8.24h1.868L12 23.357V22.31L9.71 20.083z",clipRule:"evenodd"}),et("path",{fill:"#828FA1",fillRule:"evenodd",d:"M16.348 13.604H9.72l1.116 2.954-.34 3.31h2.526l2.55-.012-.318-3.298 1.093-2.954z",clipRule:"evenodd"}),et("path",{fill:"#828FA1",fillRule:"evenodd",d:"M19.379 14.593l-2.996 1.977v3.513l-2.29 2.227v1.047l2.208 2.06h1.844l4.653-8.216-3.419-2.608z",clipRule:"evenodd"}))}function rt(){return et("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"none",viewBox:"0 0 24 24"},et("path",{fill:"#1199FA",fillRule:"evenodd",d:"M12 1.75C6.34 1.75 1.75 6.34 1.75 12S6.34 22.25 12 22.25 22.25 17.66 22.25 12 17.66 1.75 12 1.75zM.25 12C.25 5.51 5.51.25 12 .25S23.75 5.51 23.75 12 18.49 23.75 12 23.75.25 18.49.25 12z",clipRule:"evenodd"}),et("path",{fill:"#1199FA",fillRule:"evenodd",d:"M12.434.607a.75.75 0 011.059-.073C16.748 3.37 18.75 7.474 18.75 12c0 4.622-1.998 8.732-5.268 11.475a.75.75 0 11-.964-1.15c2.93-2.457 4.732-6.147 4.732-10.325 0-4.073-1.799-7.77-4.743-10.334a.75.75 0 01-.072-1.059zM11.575.618a.75.75 0 01-.093 1.057C8.552 4.132 6.75 7.822 6.75 12c0 4.073 1.798 7.77 4.743 10.334a.75.75 0 01-.986 1.132C7.252 20.63 5.25 16.526 5.25 12c0-4.622 1.998-8.732 5.268-11.475a.75.75 0 011.057.093z",clipRule:"evenodd"}),et("path",{fill:"#1199FA",fillRule:"evenodd",d:"M12 .25a.75.75 0 01.75.75v22a.75.75 0 01-1.5 0V1A.75.75 0 0112 .25z",clipRule:"evenodd"}),et("path",{fill:"#1199FA",fillRule:"evenodd",d:"M1.25 8A.75.75 0 012 7.25h20a.75.75 0 010 1.5H2A.75.75 0 011.25 8zM1.25 16a.75.75 0 01.75-.75h20a.75.75 0 010 1.5H2a.75.75 0 01-.75-.75z",clipRule:"evenodd"}))}function st(){return et("svg",{xmlns:"http://www.w3.org/2000/svg",width:"22",height:"22",fill:"none",viewBox:"0 0 22 22"},et("path",{stroke:"#1199FA",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M10.676 4.651l2.191-2.282c1.826-1.825 4.838-1.825 6.664 0 1.826 1.826 1.826 4.838 0 6.755l-4.2 4.2c-1.825 1.825-4.837 1.825-6.663 0-.274-.274-.822-1.005-1.095-1.37"}),et("path",{stroke:"#1199FA",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M10.676 4.651l2.191-2.282c1.826-1.825 4.838-1.825 6.664 0 1.826 1.826 1.826 4.838 0 6.755l-4.2 4.2c-1.825 1.825-4.837 1.825-6.663 0-.274-.274-.822-1.005-1.095-1.37"}),et("path",{stroke:"#1199FA",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M11.224 17.431l-2.191 2.282c-1.826 1.826-4.838 1.826-6.664 0-1.825-1.825-1.825-4.838 0-6.755l4.2-4.199c1.825-1.826 4.837-1.826 6.663 0 .274.274.822 1.004 1.096 1.37"}))}function ct(){return et("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"none",viewBox:"0 0 24 24"},et("path",{fill:"#1199FA",fillRule:"evenodd",d:"M5.778 10.023c-.548 0-1.028.466-1.028 1.068v9.09c0 .603.48 1.069 1.028 1.069h12.444c.548 0 1.028-.466 1.028-1.068V11.09c0-.602-.48-1.068-1.028-1.068H5.778zM3.25 11.09c0-1.398 1.12-2.568 2.528-2.568h12.444c1.408 0 2.528 1.17 2.528 2.568v9.09c0 1.399-1.12 2.569-2.528 2.569H5.778c-1.408 0-2.528-1.17-2.528-2.568V11.09zM12 2.75c-2.059 0-3.694 1.648-3.694 3.795a.75.75 0 11-1.5 0C6.806 3.602 9.08 1.25 12 1.25s5.195 2.352 5.195 5.295a.75.75 0 01-1.5 0c0-2.147-1.636-3.795-3.695-3.795z",clipRule:"evenodd"}),et("path",{fill:"#1199FA",fillRule:"evenodd",d:"M16.444 5.795a.75.75 0 01.75.75V8.91a.75.75 0 01-1.5 0V6.545a.75.75 0 01.75-.75zM7.556 5.795a.75.75 0 01.75.75v2.637a.75.75 0 11-1.5 0V6.545a.75.75 0 01.75-.75z",clipRule:"evenodd"}))}const at={overlay:{background:"rgba(12, 12, 15, 0.7)",display:"flex",position:"fixed",zIndex:2,left:0,top:0,width:"100%",height:"100%",overflow:"auto",justifyContent:"center",alignItems:"center",userSelect:"none"},container:{display:"flex",flexDirection:"row",padding:"80px",background:"linear-gradient(180deg, #021E3F 0%, #002A67 95.76%)",borderRadius:"16px",maxWidth:"1100px",overflow:"hidden"},containerLeft:{display:"flex",flexDirection:"column",marginRight:"40px",flexShrink:1,minWidth:"450px"},header:{display:"flex",alignItems:"center",flexDirection:"row"},headerLogo:{},headerText:{color:"#828FA1",margin:"10px"},headerTextDivide:{backgroundColor:"#828FA1",width:"1px",height:"32px"},title:{color:"#FFFFFF",fontWeight:600,fontSize:"28px",marginTop:"24px",marginBottom:"16px",maxWidth:"500px"},feature:{display:"flex",alignItems:"center",flexDirection:"row",marginTop:"24px"},featureIcon:{},featureText:{marginLeft:"16px",color:"#FFFFFF",fontWeight:600,fontSize:"16px"},installButton:{marginTop:"40px",height:"48px",background:"#1199FA",borderRadius:"8px",padding:"0px 36px",border:"0px solid white",fontWeight:600,fontSize:"18px",color:"#FFFFFF",alignSelf:"flex-start",cursor:"pointer",zIndex:1001},containerRight:{flexShrink:0,display:"flex",flexDirection:"column",justifyContent:"stretch",alignItems:"center",backgroundColor:"#F7F9FA",width:"360px",height:"497px",borderRadius:"16px",overflow:"hidden"},rightQRcode:{flexGrow:0,marginTop:"48px",width:"160px",height:"160px",filter:"drop-shadow(0px 0px 8px rgba(0, 0, 0, 0.16))",borderRadius:"8px"},rightTitle:{fontWeight:600,fontSize:"22px",color:"#323C52",margin:"32px 0px 8px 0px"},stretchContainer:{display:"flex",flex:1,flexGrow:1},rightStep:{container:{display:"flex",flexDirection:"row",marginTop:"8px",alignSelf:"flex-start",marginLeft:"46px"},dot:{},desc:{fontSize:"16px",color:"#5D667B"},camera:{margin:"0px 8px"}},terms:{container:{display:"flex",flexDirection:"row",alignSelf:"stretch",justifyContent:"center",marginBottom:"16px"},text:{fontSize:"10px",color:"#5D667B"},link:{fontSize:"10px",color:"#4399F3",margin:"0px 4px",cursor:"pointer"}}},lt={container:{display:"flex",flexDirection:"row",justifyContent:"stretch",alignItems:"center",alignSelf:"stretch",backgroundColor:"white"},logoIcon:{width:"30px",height:"30px",padding:"5px",backgroundColor:"white",filter:"drop-shadow(0px 0px 8px rgba(0, 0, 0, 0.16))",borderRadius:"6px"},textContainer:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1},title:{fontWeight:600,fontSize:"14px",lineHeight:"150%",color:"#323C52"},desc:{fontWeight:500,fontSize:"10px",lineHeight:"150%",color:"#7B849B"},button:{width:"75px",height:"34px",background:"#1199FA",border:"0px solid white",borderRadius:"4px",fontWeight:600,fontSize:"12px",color:"#FFFFFF",marginRight:"12px",cursor:"pointer",zIndex:1001}},ht={name:"Crypto.com DeFi Wallet",shortName:"DeFi Wallet",color:"rgb(17, 153, 250)",logo:"./logos/wallet-crypto-defi.png",universalLink:"https://wallet.crypto.com",deepLink:"cryptowallet:"},dt=(t,e)=>{if(d())window.open(t);else{let n=!1;window.addEventListener("blur",()=>{n=!0}),window.addEventListener("visibilitychange",()=>{document.hidden&&(n=!0)}),window.location.href=t,setTimeout(()=>{n||window.open(e)},1500)}},ut={open:async function(t,e,n){const i=Z(t)+"&role=dapp";if(d()){const t=u(i,ht);return p({name:"Crypto.com DeFi Wallet",href:t}),void dt(t,"https://bit.ly/3Bk4wzE")}if(f()){const t=$(i,"cwe")+"&role=dapp";return p({name:"Unknown",href:t}),void dt(t,"https://bit.ly/3Bk4wzE")}const o=document.body,r=document.createElement("div");r.id="cryptoconnect-extension",o.appendChild(r);try{const t=await new Promise(t=>v.toDataURL(i,(e,n)=>t(n))),n=et(pt,{qrUrl:t});o.appendChild(n);const s=()=>{var t,e;null==(t=n.parentElement)||t.removeChild(n),null==(e=r.parentElement)||e.removeChild(r),window.removeEventListener("InstallExtensionQRCodeModal_Event_close",s)};window.addEventListener("InstallExtensionQRCodeModal_Event_close",s),n.onclick=()=>{e(),s()}}catch(t){}},close:function(){window.dispatchEvent(new Event("InstallExtensionQRCodeModal_Event_close"))}},pt=t=>{const{qrUrl:e}=t;return et("div",{style:at.overlay},et("div",{style:at.container,onClick:t=>null==t?void 0:t.stopPropagation()},et("div",{style:at.containerLeft},et("div",{style:at.header},et(ot,null),et("div",{style:at.headerText},"crypto.com"),et("div",{style:at.headerTextDivide}),et("div",{style:at.headerText},"WALLET EXTENSION")),et("div",{style:at.title},"Access DApps on desktop by connecting DeFi Wallet to Wallet Extension"),et("div",{style:at.feature},et(st,null),et("div",{style:at.featureText},"Stable connection to DApps")),et("div",{style:at.feature},et(ct,null),et("div",{style:at.featureText},"Secure signing via DeFi Wallet")),et("div",{style:at.feature},et(rt,null),et("div",{style:at.featureText},"Smooth App navigation with DApp connection")),et("button",{style:at.installButton,onClick:()=>{window.open("https://wallet.crypto.com/api/v1/extension/install")}},"Install DeFi Wallet Extension")),et("div",{style:at.containerRight},et("img",{style:at.rightQRcode,src:e,alt:"qrcode"}),et("span",{style:at.rightTitle},"Scan to Connect"),et("div",{style:at.rightStep.container},et("div",{style:at.rightStep.desc},"• Open DeFi Wallet Mobile App")),et("div",{style:at.rightStep.container},et("div",{style:at.rightStep.desc},"• Tap"),et(it,{style:at.rightStep.camera}),et("div",{style:at.rightStep.desc},"to switch on the camera")),et("div",{style:at.rightStep.container},et("div",{style:at.rightStep.desc},"• Scan the QR code above")),et("div",{style:at.stretchContainer}),et("div",{style:at.terms.container},et("div",{style:at.terms.text},"Crypto.com DeFi Wallet "),et("div",{style:at.terms.link,onClick:()=>{window.open("https://crypto.com/document/ncw_tnc")}},"Terms & Conditions"),et("div",{style:at.terms.text},"and"),et("div",{style:at.terms.link,onClick:()=>{window.open("https://crypto.com/privacy/ncw")}},"Privacy Notice")),et(ft,{onDownloadClick:()=>{window.open("https://bit.ly/3Bk4wzE")}}))))},ft=t=>{const{onDownloadClick:e}=t;return et("div",{style:lt.container},et(nt,null),et("div",{style:lt.textContainer},et("div",{style:lt.title},"Crypto.com DeFi Wallet"),et("div",{style:lt.desc},"Your Keys, Your Crypto.")),et("button",{style:lt.button,onClick:e},"Download"))};var vt=null;try{vt=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(t){}function gt(t,e,n){this.low=0|t,this.high=0|e,this.unsigned=!!n}function mt(t){return!0===(t&&t.__isLong__)}Object.defineProperty(gt.prototype,"__isLong__",{value:!0}),gt.isLong=mt;var yt={},wt={};function xt(t,e){var n,i,o;return e?(o=0<=(t>>>=0)&&t<256)&&(i=wt[t])?i:(n=Ct(t,(0|t)<0?-1:0,!0),o&&(wt[t]=n),n):(o=-128<=(t|=0)&&t<128)&&(i=yt[t])?i:(n=Ct(t,t<0?-1:0,!1),o&&(yt[t]=n),n)}function bt(t,e){if(isNaN(t))return e?Ot:Rt;if(e){if(t<0)return Ot;if(t>=St)return Bt}else{if(t<=-kt)return Mt;if(t+1>=kt)return Dt}return t<0?bt(-t,e).neg():Ct(t%Lt|0,t/Lt|0,e)}function Ct(t,e,n){return new gt(t,e,n)}gt.fromInt=xt,gt.fromNumber=bt,gt.fromBits=Ct;var Et=Math.pow;function _t(t,e,n){if(0===t.length)throw Error("empty string");if("NaN"===t||"Infinity"===t||"+Infinity"===t||"-Infinity"===t)return Rt;if("number"==typeof e?(n=e,e=!1):e=!!e,(n=n||10)<2||36<n)throw RangeError("radix");var i;if((i=t.indexOf("-"))>0)throw Error("interior hyphen");if(0===i)return _t(t.substring(1),e,n).neg();for(var o=bt(Et(n,8)),r=Rt,s=0;s<t.length;s+=8){var c=Math.min(8,t.length-s),a=parseInt(t.substring(s,s+c),n);if(c<8){var l=bt(Et(n,c));r=r.mul(l).add(bt(a))}else r=(r=r.mul(o)).add(bt(a))}return r.unsigned=e,r}function It(t,e){return"number"==typeof t?bt(t,e):"string"==typeof t?_t(t,e):Ct(t.low,t.high,"boolean"==typeof e?e:t.unsigned)}gt.fromString=_t,gt.fromValue=It;var Lt=4294967296,St=Lt*Lt,kt=St/2,Ft=xt(1<<24),Rt=xt(0);gt.ZERO=Rt;var Ot=xt(0,!0);gt.UZERO=Ot;var Nt=xt(1);gt.ONE=Nt;var Tt=xt(1,!0);gt.UONE=Tt;var At=xt(-1);gt.NEG_ONE=At;var Dt=Ct(-1,2147483647,!1);gt.MAX_VALUE=Dt;var Bt=Ct(-1,-1,!0);gt.MAX_UNSIGNED_VALUE=Bt;var Mt=Ct(0,-2147483648,!1);gt.MIN_VALUE=Mt;var zt=gt.prototype;zt.toInt=function(){return this.unsigned?this.low>>>0:this.low},zt.toNumber=function(){return this.unsigned?(this.high>>>0)*Lt+(this.low>>>0):this.high*Lt+(this.low>>>0)},zt.toString=function(t){if((t=t||10)<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(Mt)){var e=bt(t),n=this.div(e),i=n.mul(e).sub(this);return n.toString(t)+i.toInt().toString(t)}return"-"+this.neg().toString(t)}for(var o=bt(Et(t,6),this.unsigned),r=this,s="";;){var c=r.div(o),a=(r.sub(c.mul(o)).toInt()>>>0).toString(t);if((r=c).isZero())return a+s;for(;a.length<6;)a="0"+a;s=""+a+s}},zt.getHighBits=function(){return this.high},zt.getHighBitsUnsigned=function(){return this.high>>>0},zt.getLowBits=function(){return this.low},zt.getLowBitsUnsigned=function(){return this.low>>>0},zt.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Mt)?64:this.neg().getNumBitsAbs();for(var t=0!=this.high?this.high:this.low,e=31;e>0&&0==(t&1<<e);e--);return 0!=this.high?e+33:e+1},zt.isZero=function(){return 0===this.high&&0===this.low},zt.eqz=zt.isZero,zt.isNegative=function(){return!this.unsigned&&this.high<0},zt.isPositive=function(){return this.unsigned||this.high>=0},zt.isOdd=function(){return 1==(1&this.low)},zt.isEven=function(){return 0==(1&this.low)},zt.equals=function(t){return mt(t)||(t=It(t)),(this.unsigned===t.unsigned||this.high>>>31!=1||t.high>>>31!=1)&&this.high===t.high&&this.low===t.low},zt.eq=zt.equals,zt.notEquals=function(t){return!this.eq(t)},zt.neq=zt.notEquals,zt.ne=zt.notEquals,zt.lessThan=function(t){return this.comp(t)<0},zt.lt=zt.lessThan,zt.lessThanOrEqual=function(t){return this.comp(t)<=0},zt.lte=zt.lessThanOrEqual,zt.le=zt.lessThanOrEqual,zt.greaterThan=function(t){return this.comp(t)>0},zt.gt=zt.greaterThan,zt.greaterThanOrEqual=function(t){return this.comp(t)>=0},zt.gte=zt.greaterThanOrEqual,zt.ge=zt.greaterThanOrEqual,zt.compare=function(t){if(mt(t)||(t=It(t)),this.eq(t))return 0;var e=this.isNegative(),n=t.isNegative();return e&&!n?-1:!e&&n?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1},zt.comp=zt.compare,zt.negate=function(){return!this.unsigned&&this.eq(Mt)?Mt:this.not().add(Nt)},zt.neg=zt.negate,zt.add=function(t){mt(t)||(t=It(t));var e=0,n=0,i=0,o=0;return i+=(o+=(65535&this.low)+(65535&t.low))>>>16,n+=(i+=(this.low>>>16)+(t.low>>>16))>>>16,e+=(n+=(65535&this.high)+(65535&t.high))>>>16,e+=(this.high>>>16)+(t.high>>>16),Ct((i&=65535)<<16|(o&=65535),(e&=65535)<<16|(n&=65535),this.unsigned)},zt.subtract=function(t){return mt(t)||(t=It(t)),this.add(t.neg())},zt.sub=zt.subtract,zt.multiply=function(t){if(this.isZero())return Rt;if(mt(t)||(t=It(t)),vt)return Ct(vt.mul(this.low,this.high,t.low,t.high),vt.get_high(),this.unsigned);if(t.isZero())return Rt;if(this.eq(Mt))return t.isOdd()?Mt:Rt;if(t.eq(Mt))return this.isOdd()?Mt:Rt;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(Ft)&&t.lt(Ft))return bt(this.toNumber()*t.toNumber(),this.unsigned);var e=65535&this.high,n=this.low>>>16,i=65535&this.low,o=65535&t.high,r=t.low>>>16,s=65535&t.low,c=0,a=0,l=0,h=0;return l+=(h+=i*s)>>>16,a+=(l+=n*s)>>>16,l&=65535,a+=(l+=i*r)>>>16,c+=(a+=e*s)>>>16,a&=65535,c+=(a+=n*r)>>>16,a&=65535,c+=(a+=i*o)>>>16,c+=(this.high>>>16)*s+e*r+n*o+i*(t.high>>>16),Ct((l&=65535)<<16|(h&=65535),(c&=65535)<<16|(a&=65535),this.unsigned)},zt.mul=zt.multiply,zt.divide=function(t){if(mt(t)||(t=It(t)),t.isZero())throw Error("division by zero");var e,n,i;if(vt)return this.unsigned||-2147483648!==this.high||-1!==t.low||-1!==t.high?Ct((this.unsigned?vt.div_u:vt.div_s)(this.low,this.high,t.low,t.high),vt.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?Ot:Rt;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return Ot;if(t.gt(this.shru(1)))return Tt;i=Ot}else{if(this.eq(Mt))return t.eq(Nt)||t.eq(At)?Mt:t.eq(Mt)?Nt:(e=this.shr(1).div(t).shl(1)).eq(Rt)?t.isNegative()?Nt:At:(n=this.sub(t.mul(e)),i=e.add(n.div(t)));if(t.eq(Mt))return this.unsigned?Ot:Rt;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();i=Rt}for(n=this;n.gte(t);){e=Math.max(1,Math.floor(n.toNumber()/t.toNumber()));for(var o=Math.ceil(Math.log(e)/Math.LN2),r=o<=48?1:Et(2,o-48),s=bt(e),c=s.mul(t);c.isNegative()||c.gt(n);)c=(s=bt(e-=r,this.unsigned)).mul(t);s.isZero()&&(s=Nt),i=i.add(s),n=n.sub(c)}return i},zt.div=zt.divide,zt.modulo=function(t){return mt(t)||(t=It(t)),vt?Ct((this.unsigned?vt.rem_u:vt.rem_s)(this.low,this.high,t.low,t.high),vt.get_high(),this.unsigned):this.sub(this.div(t).mul(t))},zt.mod=zt.modulo,zt.rem=zt.modulo,zt.not=function(){return Ct(~this.low,~this.high,this.unsigned)},zt.and=function(t){return mt(t)||(t=It(t)),Ct(this.low&t.low,this.high&t.high,this.unsigned)},zt.or=function(t){return mt(t)||(t=It(t)),Ct(this.low|t.low,this.high|t.high,this.unsigned)},zt.xor=function(t){return mt(t)||(t=It(t)),Ct(this.low^t.low,this.high^t.high,this.unsigned)},zt.shiftLeft=function(t){return mt(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?Ct(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):Ct(0,this.low<<t-32,this.unsigned)},zt.shl=zt.shiftLeft,zt.shiftRight=function(t){return mt(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?Ct(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):Ct(this.high>>t-32,this.high>=0?0:-1,this.unsigned)},zt.shr=zt.shiftRight,zt.shiftRightUnsigned=function(t){if(mt(t)&&(t=t.toInt()),0==(t&=63))return this;var e=this.high;return t<32?Ct(this.low>>>t|e<<32-t,e>>>t,this.unsigned):Ct(32===t?e:e>>>t-32,0,this.unsigned)},zt.shru=zt.shiftRightUnsigned,zt.shr_u=zt.shiftRightUnsigned,zt.toSigned=function(){return this.unsigned?Ct(this.low,this.high,!1):this},zt.toUnsigned=function(){return this.unsigned?this:Ct(this.low,this.high,!0)},zt.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},zt.toBytesLE=function(){var t=this.high,e=this.low;return[255&e,e>>>8&255,e>>>16&255,e>>>24,255&t,t>>>8&255,t>>>16&255,t>>>24]},zt.toBytesBE=function(){var t=this.high,e=this.low;return[t>>>24,t>>>16&255,t>>>8&255,255&t,e>>>24,e>>>16&255,e>>>8&255,255&e]},gt.fromBytes=function(t,e,n){return n?gt.fromBytesLE(t,e):gt.fromBytesBE(t,e)},gt.fromBytesLE=function(t,e){return new gt(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,e)},gt.fromBytesBE=function(t,e){return new gt(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],e)};const jt=t=>{const e={};if(t instanceof Array)return t.map(t=>jt(t));if(t&&"string"==typeof t.typeUrl&&"string"==typeof t.value)try{const e=function(t){var e;const n=null==(e=E.find(e=>e[0]===t))?void 0:e[1];if(n&&C(n))return n;throw new Error(`can not find ProtoGeneratedType for typeUrl:${t}`)}(t.typeUrl);return{typeUrl:t.typeUrl,value:jt(e.toJSON(e.decode(m(t.value))))}}catch(e){return t}for(const n in t){const i=t[n];e[n]="object"!=typeof i?i:jt(i)}return e};function Ut(t){return void 0!==t.isDeFiCosmosProvider}class qt{constructor(t){var e=this;this.isDeFiCosmosProvider=!0,this.client=void 0,this.config=void 0,this.sendTransaction=async function(t){const{chainId:n,chainType:i}=e.client.connector.session;return e.client.connector.sendJSONRequest({method:"cosmos_sendTransaction",params:[t],session:{chainId:n,chainType:i,account:e.account}},{forcePushNotification:!0})},this.request=async function(t){},this.send=async function(t,e){},this.stop=async function(){},this.close=async function(){await e.client.connector.killSession(),await e.stop()};const{client:n}=t;this.config=t,this.client=n}get account(){var t;return null!=(t=this.client.connector.session.accounts[0])?t:""}get currentAccountInfo(){const t=Object.entries(this.client.connector.session.wallets[0].addresses).find(([t,e])=>e.address==this.account);return null==t?void 0:t[1]}get signer(){var t,e=this;const n=this.currentAccountInfo;if(!n||!n.pubkey)throw new Error("can not get the OfflineSigner, there is an unsupported address type");const i={address:n.address,algo:"secp256k1",pubkey:m(null!=(t=n.pubkey)?t:"")};return{getAccounts:async function(){return[i]},signDirect:async function(t,n){const o=await e.sendTransaction(((t,e)=>{const n=w.decode(e.bodyBytes),i=x.decode(e.authInfoBytes);return{signerAddress:t,signDoc:{chainId:e.chainId,accountNumber:e.accountNumber.toString(),body:jt(w.toJSON(n)),authInfo:jt(x.toJSON(i))}}})(t,n)),r=b.decode(m(o)),s=y(r.signatures[0]);return{signed:{bodyBytes:r.bodyBytes,authInfoBytes:r.authInfoBytes,chainId:n.chainId,accountNumber:n.accountNumber},signature:{pub_key:{type:g.secp256k1,value:i.pubkey},signature:s}}}}}async enable(){return this.client.connector.connected||await this.client.connector.connect({chainId:this.config.supportedChainIds[0],chainType:"cosmos"}),this.client.connector.accounts}}class Wt{constructor({key:t="DeFiLink_session_storage_dapp",supportedChainIds:e}){this.key=void 0,this.supportedChainIds=void 0,this.getSession=()=>{const t=i(this.key);return(e=t)&&void 0!==e.bridge&&void 0!==e.chainId&&void 0!==e.chainType&&void 0!==e.wallets&&void 0!==e.wallets&&void 0!==e.wallets[0]&&void 0!==e.wallets[0].addresses&&void 0!==e.wallets[0].addresses.eth&&void 0!==e.accounts&&e.accounts.length>0&&this.supportedChainIds.includes(t.chainId)?t:null;var e},this.setSession=t=>(this.supportedChainIds.includes(t.chainId)&&o(this.key,t),t),this.removeSession=()=>{r(this.key)},this.key=t,this.supportedChainIds=e}}var Pt;!function(t){t.Update="DeFiConnectorUpdate",t.Error="DeFiConnectorError",t.Deactivate="DeFiConnectorDeactivate"}(Pt||(Pt={}));const Vt=t=>"eth"===t||"cosmos"===t?t:"eth";class Ht extends W{constructor(t){super(),this.config=void 0,this.eventEmitters=[],this.connectorClient=void 0,this._provider=void 0,this.chainId="",this.chainType="eth",this.accounts=[],this.config=t}async getProvider(){return this.provider}async getChainId(){return this.chainId}async getAccount(){return this.accounts[0]}get _supportedChainIds(){var t,e,n,i;const o=null!=(t=null==(e=this.config.eth)?void 0:e.supportedChainIds.map(t=>t.toString()))?t:[],r=null!=(n=null==(i=this.config.cosmos)?void 0:i.supportedChainIds)?n:[];return o.concat(r)}async generateClient(){var t=this;let e;if(await async function(t=0){return new Promise(e=>{!function n(){t>0&&"function"!=typeof window.deficonnectClientGenerator?setTimeout(async function(){--t,n()},100):e(!0)}()})}(10),"function"==typeof window.deficonnectClientGenerator)e=await window.deficonnectClientGenerator(this.config),void 0===e.clearSessionStorage&&(e.clearSessionStorage=K.prototype.clearSessionStorage);else{var n;const t={bridge:H(null!=(n=this.config.bridge)?n:"https://wallet-connect.crypto.com/api/v1/ncwconnect/relay/ws",{role:"dapp",dapp_name:this.config.name}),qrcodeModal:ut},i=new Wt({supportedChainIds:this._supportedChainIds});e=new K({connectorOpts:t,sessionStorage:i})}return e.connector.on("disconnect",()=>{this.emitDeactivate()}),e.connector.on("session_update",async function(n,i){var o;if(n)return void t.emitError(new Error(n.message));if(null==i||!i.params[0])return;const{params:[{chainId:r,chainType:s,accounts:c}]=[]}=i;r&&s&&c&&(t.chainId=r,t.chainType=s,t.accounts=c,t.provider=await t.generateProvider({chainId:r,chainType:s,connectorClient:e,config:t.config}),await(null==(o=t.provider)?void 0:o.enable()),t.emitUpdate({account:c[0],chainType:s,chainId:r,provider:t.provider}))}),e}async generateProvider(t){const{chainId:e,chainType:n,connectorClient:i}=t;if("function"==typeof window.deficonnectProviderGenerator)return await window.deficonnectProviderGenerator({chainId:e,chainType:n,config:this.config,connectorClient:i});if("eth"===n)return new c(P({},this.config.eth,{connector:i.connector}));var o,r;if("cosmos"===n)return new qt({supportedChainIds:null!=(o=null==(r=this.config.cosmos)?void 0:r.supportedChainIds)?o:[],client:i});throw new Error("must provider eth or cosmos config")}async activate(){try{var t;let i=this.connectorClient;if(i||(i=await this.generateClient()),0==this.config.supprtedChainTypes.length)throw new Error("must provider supprtedNetworks");const o=this.config.supprtedChainTypes[0];let r="1";if("eth"===o){var e;if(null==this.config.eth)throw new Error("must provider eth config");r=`${null!=(e=this.config.eth.supportedChainIds[0])?e:1}`}if("cosmos"===o){var n;if(null==this.config.cosmos)throw new Error("must provider cosmos config");r=`${null!=(n=this.config.cosmos.supportedChainIds[0])?n:1}`}const{chainId:s,chainType:c,accounts:a}=await i.connector.connect({chainId:r,chainType:o});return this.chainId=s,this.chainType=Vt(c),this.accounts=a,this.provider=await this.generateProvider({chainId:s,chainType:c,connectorClient:i,config:this.config}),await(null==(t=this.provider)?void 0:t.enable()),this.connectorClient=i,{account:a[0],chainType:Vt(c),chainId:s,provider:this.provider}}catch(t){throw t}}getAddressList(t){const e=this.connectorClient;if(!e)throw new Error("you has not active this connector");return t.map(t=>({type:t,address:e.connector.session.wallets[0].addresses[t].address}))}async close(){var t;null==(t=this.connectorClient)||t.clearSessionStorage();try{var e;await(null==(e=this.provider)?void 0:e.close())}finally{var n;await(null==(n=this.connectorClient)?void 0:n.connector.killSession())}}async deactivate(){var t,e,n,i;null==(t=this.connectorClient)||t.clearSessionStorage(),"function"==typeof(null==(e=this.provider)?void 0:e.stop)&&(null==(i=this.provider)||i.stop()),await(null==(n=this.connectorClient)?void 0:n.connector.killSession()),this.emitDeactivate()}get provider(){return this._provider}set provider(t){this._provider=t}onEvent(t,e){const n={event:t,callback:e};return this.eventEmitters.push(n),()=>{this.eventEmitters=this.eventEmitters.filter(t=>t!==n)}}emitUpdate(t){this.eventEmitters.forEach(e=>{e.event===Pt.Update&&e.callback(t,void 0)})}emitError(t){this.eventEmitters.forEach(e=>{e.event===Pt.Error&&e.callback(void 0,t)})}emitDeactivate(){this.eventEmitters.forEach(t=>{t.event===Pt.Deactivate&&t.callback(void 0,void 0)}),this.connectorClient=void 0}}const Gt="URI_AVAILABLE";class $t extends Error{constructor(){super(),this.name=this.constructor.name,this.message="The user rejected the request."}}function Zt({supportedChainIds:t,rpc:e}){return t||(e?Object.keys(e).map(t=>Number(t)):void 0)}function Qt(t){try{const e=parseInt(null!=t?t:"0");return isNaN(e)?0:e}catch(t){return 0}}class Jt extends W{constructor(t){var e,n,i;super({supportedChainIds:Zt(t)}),this.defiConnector=void 0,this._injectConnect=void 0;const o=s()||void 0;this.defiConnector=new Ht({name:null!=(e=null==o?void 0:o.name)?e:"",supprtedChainTypes:["eth"],bridge:t.bridge,eth:t}),this.defiConnector.onEvent(Pt.Update,t=>{if(!t)return;const{chainId:e,provider:n,account:i}=t;this.emitUpdate({chainId:Qt(e),provider:n,account:i})}),this.defiConnector.onEvent(Pt.Deactivate,()=>{this.emitDeactivate()}),null!=(n=navigator)&&null!=(i=n.userAgent)&&i.includes("DeFiWallet")&&window.ethereum&&(this._injectConnect=new _({supportedChainIds:t.supportedChainIds}))}async activate(){if(this._injectConnect)return await this._injectConnect.activate();const{chainId:t,provider:e,account:n}=await this.defiConnector.activate();return{chainId:Qt(t),provider:e,account:n}}async getProvider(){return this._injectConnect?await this._injectConnect.getProvider():this.defiConnector.provider}async getChainId(){return this._injectConnect?await this._injectConnect.getChainId():Qt(this.defiConnector.chainId)}async getAccount(){return this._injectConnect?await this._injectConnect.getAccount():(await this.getProvider()).send("eth_accounts").then(t=>t[0])}close(){return this.defiConnector.close()}deactivate(){if(this._injectConnect)return this._injectConnect.deactivate();this.defiConnector.deactivate()}}export{Ht as DeFiConnector,K as DeFiConnectorClient,Pt as DeFiConnectorUpdateEvent,qt as DeFiCosmosProvider,Jt as DeFiWeb3Connector,Gt as URI_AVAILABLE,$t as UserRejectedRequestError,H as addUrlParams,Z as formatToCWEURI,Q as formatToWCURI,G as formatUriAddUrlParams,Ut as isDeFiCosmosProvider,J as limitWords,V as removeAllUrlParams,$ as replaceUriProtocol};
//# sourceMappingURL=index.modern.js.map
